<html>

<head>
    <title>UMA VR</title>
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
    <script>
        var umaPrograms = [
            'Architecture',
            'Art',
            'Aviation',
            'Applied Science',
            'Biology',
            'Business Administration',
            'Computer Information Systems',
            'Dental Assisting',
            'Dental Hygiene',
            'English',
            'Financial Services',
            'Interdisciplinary Studies',
            'Information and Library Services',
            'Justice Studies',
            'Liberal Studies',
            'Mental Health and Human Services',
            'Medical Laboratory Technology',
            'Jazz and Contemporary Music',
            'Nursing',
            'Public Administration',
            'Social Science',
            'Veterinary Technology'
        ];

        function shuffle(array) {
            var currentIndex = array.length, temporaryValue, randomIndex;

            // While there remain elements to shuffle...
            while (0 !== currentIndex) {

                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;

                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }

            return array;
        }

        AFRAME.registerComponent('uma-programs', {
            init: function () {
                // Solution for Creating Entities.
                var sceneEl = document.querySelector('a-scene');

                var randomPrograms = shuffle(umaPrograms);

                var angFrac = 360 / randomPrograms.length;
                var ang = 0.00;
                var radius = 5.0;
                var up = new THREE.Vector3(0, 1, 0);

                for (var i = 0; i < randomPrograms.length; i++) {
                    var x = i, y = i, z = 1;
                    console.log(ang);

                    var pos = {
                        x: radius * Math.sin(THREE.Math.degToRad(ang)),
                        y: ((i % 2)*0.5),
                        z: radius * Math.cos(THREE.Math.degToRad(ang))
                    };

                    //alert(pos);

                    var rot = new THREE.Quaternion();
                    rot.setFromAxisAngle(up, ang);
                    //console.log(rot);

                    var vectorRot = new THREE.Vector3(
                        THREE.Math.degToRad(pos.x),
                        THREE.Math.degToRad(pos.y),
                        THREE.Math.degToRad(pos.z)
                    );
                    vectorRot.applyQuaternion(rot);
                    //console.log(vectorRot);

                    /*var stringRot = THREE.Math.radToDeg(vectorRot.x) + " " + 
                    THREE.Math.radToDeg(vectorRot.y) + " " + 
                    THREE.Math.radToDeg(vectorRot.z);*/
                    var rotAng = 0.00;

                    if (ang < 180) {
                        rotAng = -(180 - ang);
                    } else {
                        rotAng = ang - 180;
                    }

                    var stringRot = "0 " + rotAng.toFixed(0) + " 0";
                    console.log(stringRot);

                    var boxEl = document.createElement('a-entity');
                    boxEl.setAttribute('text', 'color: white; align: center; width: 4; font: exo2semibold; value: ' + randomPrograms[i]);
                    boxEl.setAttribute('position', pos);
                    boxEl.setAttribute('rotation', stringRot); // all show up with "-90 0 0"
                    sceneEl.appendChild(boxEl);

                    boxEl.addEventListener('trackpaddown', function(e) {
                        var text = e.target.getAttribute('text');
                        text.color = '#BBB';
                        e.target.setAttribute('text', text);
                    });
                    boxEl.addEventListener('mouseenter', function(e) {
                        var text = e.target.getAttribute('text');
                        text.color = '#BBB';
                        e.target.setAttribute('text', text);
                    });
                    boxEl.addEventListener('mouseleave', function(e) {
                        var text = e.target.getAttribute('text');
                        text.color = 'white';
                        e.target.setAttribute('text', text);
                    });

                    ang += angFrac;
                }
            }
        });
    </script>
</head>

<body>
    <a-scene uma-programs>
        <a-assets>
            <img id="green" src="quad-backdrop.jpg">
            <!--<img id="groundTexture" src="https://cdn.aframe.io/a-painter/images/floor.jpg">-->
        </a-assets>
        <!--<a-box position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9"></a-box>
        <a-sphere position="0 1.25 -5" radius="1.25" color="#EF2D5E"></a-sphere>
        <a-cylinder position="1 0.75 -3" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>-->
        <a-sky src="#green" position="" rotation="" scale="" visible="" material="" geometry=""></a-sky>
        <!--<a-plane src="#groundTexture" rotation="-90 0 0" width="10" height="10" repeat="10 10"></a-plane>-->

        <a-text value="Welcome to UMA! Choose a program:" color="#BBB" position="-3 2 -3" scale="1.5 1.5 1.5"></a-text>

        <!-- Match Daydream controller if present, regardless of hand. -->
        <!--<a-entity daydream-controls></a-entity>-->
        
        <a-camera><a-cursor></a-cursor></a-camera>
    </a-scene>
</body>

</html>